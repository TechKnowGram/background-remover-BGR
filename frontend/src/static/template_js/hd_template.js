$(document).on('ready',function(e){});function hd_car_design_template(hd_req_obj){if(hd_req_obj.is_image_downloaded=="0"){var csrftoken=$('meta[name=csrf-token]').attr('content');var formdata=new FormData();$.ajaxSetup({beforeSend:function(xhr,settings){if(!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)){xhr.setRequestHeader("X-CSRFToken",csrftoken)}}});$.ajax({url:'/get_credit_info',type:'POST',processData:false,contentType:false,data:formdata,success:function(data){var obj=JSON.parse(data);if(obj.status_value==4586){$.cookie('_slzPageURL_',window.location.pathname,{expires:1/24});window.location.href='/login';}else if(obj.status_value==5692){window.location.href='/account';}else if(obj.status_value==1476){if(hd_req_obj.template_details.type=='change_background'){get_full_size_image_from_api(hd_req_obj,0)}else if(hd_req_obj.template_details.type=='real_estate'){get_full_size_image_from_api(hd_req_obj,0)}else{get_full_size_image_from_api(hd_req_obj)}}},error:function(err){}});}else{get_hd_template_from_api(hd_req_obj)}}
function get_full_size_image_from_api(hd_req_obj,trim_extra_transparent_area=1){var csrftoken=$('meta[name=csrf-token]').attr('content');var formdata=new FormData();formdata.append("api_source",'design_template');formdata.append("image_url",hd_req_obj.image_url);formdata.append("source_image_width",hd_req_obj.source_image_width);formdata.append("source_image_height",hd_req_obj.source_image_height);formdata.append("output_image_width",hd_req_obj.output_image_width);formdata.append("output_image_height",hd_req_obj.output_image_height);formdata.append("is_image_downloaded",hd_req_obj.is_image_downloaded);formdata.append("client","slazzer_design_template");formdata.append("trim_extra_transparent_area",trim_extra_transparent_area);formdata.append("hd_template_obj",JSON.stringify(hd_req_obj.template_details));$.ajaxSetup({beforeSend:function(xhr,settings){if(!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)){xhr.setRequestHeader("X-CSRFToken",csrftoken)}}});$.ajax({url:'/get_full_size_image',type:'POST',processData:false,contentType:false,data:formdata,success:function(data){var obj=JSON.parse(data);if(obj.status){hd_req_obj.is_image_downloaded="1";var full_image_path=obj.full_image_url;hd_req_obj.template_details.full_hd_image_path=full_image_path;get_hd_template_from_api(hd_req_obj)}},error:function(err){}});}
function get_hd_template_from_api(hd_req_obj){var csrftoken=$('meta[name=csrf-token]').attr('content');var formdata=new FormData();formdata.append("hd_template_obj",JSON.stringify(hd_req_obj.template_details));$.ajaxSetup({beforeSend:function(xhr,settings){if(!/^(GET|HEAD|OPTIONS|TRACE)$/i.test(settings.type)){xhr.setRequestHeader("X-CSRFToken",csrftoken)}}});$.ajax({url:'/design_template',type:'POST',processData:false,contentType:false,data:formdata,success:function(data){$('#btnDownloadHD').removeClass('btn-hd');var obj=JSON.parse(data);if(obj.status){hd_req_obj.template_details.full_hd_template_path=obj.template_url;var full_image_path=obj.template_url;var img_name_arr=full_image_path.split('/');var image_name=img_name_arr[img_name_arr.length-1];var a=document.createElement('a');a.href=full_image_path;a.download=image_name;document.body.appendChild(a);a.click();document.body.removeChild(a);$('#btnDownloadHD').removeClass('btn-hd');}},error:function(err){}});}